<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAS Enhanced Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <span style="left: 10%; animation-delay: 0s;"></span>
        <span style="left: 20%; animation-delay: 2s;"></span>
        <span style="left: 30%; animation-delay: 4s;"></span>
        <span style="left: 40%; animation-delay: 6s;"></span>
        <span style="left: 50%; animation-delay: 8s;"></span>
        <span style="left: 60%; animation-delay: 10s;"></span>
        <span style="left: 70%; animation-delay: 12s;"></span>
        <span style="left: 80%; animation-delay: 14s;"></span>
        <span style="left: 90%; animation-delay: 16s;"></span>
    </div>
    
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1><i class="fas fa-car"></i> ADAS Enhanced Dashboard</h1>
                <p>Advanced Driver Assistance System - Real-time Monitoring</p>
            </div>
            <div class="header-right">
                <div class="status-badge idle" id="main-status">
                    <span class="status-dot"></span>
                    <span>Ready</span>
                </div>
            </div>
        </div>
        
        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Video Section -->
            <div class="video-section">
                <!-- Video Status - Above Video -->
                <div class="video-status-bar">
                    <i class="fas fa-circle" id="stream-indicator" style="color: #f59e0b;"></i>
                    <span id="stream-status">Idle</span>
                </div>
                <div class="video-container">
                    <div class="video-placeholder" id="video-placeholder">
                        <i class="fas fa-video"></i>
                        <h3>No Active Stream</h3>
                        <p>Start webcam or upload a video to begin processing</p>
                    </div>
                    <img id="video-stream" class="video-stream" src="/video_feed" alt="ADAS Video Stream" style="display: none;">
                    
                    <!-- Steering Wheel Overlay - Top Right -->
                    <div class="steering-overlay-top" id="steering-overlay" style="display: none;">
                        <img src="{{ url_for('static', filename='assets/steering_wheel.png') }}" alt="Steering Wheel" class="steering-wheel" id="steering-wheel" 
                             onerror="console.error('Failed to load steering wheel'); this.style.display='none';">
                        <div class="steering-angle" id="steering-angle">0°</div>
                    </div>
                </div>
            </div>
            
            <!-- Control Panel -->
            <div class="control-panel">
                <!-- Video Controls -->
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-video"></i>
                        Video Controls
                    </div>
                    <button class="btn-custom btn-primary-custom" onclick="startWebcam()">
                        <i class="fas fa-camera"></i>
                        <span>Start Webcam</span>
                    </button>
                    <button class="btn-custom btn-success-custom" onclick="document.getElementById('videoUpload').click()">
                        <i class="fas fa-upload"></i>
                        <span>Upload Video</span>
                    </button>
                    <input type="file" id="videoUpload" accept="video/*" style="display: none;" onchange="uploadVideo(this)">
                    <button class="btn-custom btn-danger-custom" onclick="stopVideo()">
                        <i class="fas fa-stop"></i>
                        <span>Stop Stream</span>
                    </button>
                </div>
                
                <!-- Performance Metrics -->
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Performance Metrics
                    </div>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas fa-tachometer-alt"></i></div>
                            <div class="metric-label">FPS</div>
                            <div class="metric-value" id="metric-fps">0.00</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas fa-film"></i></div>
                            <div class="metric-label">Frames</div>
                            <div class="metric-value" id="metric-frames">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas fa-exclamation-triangle"></i></div>
                            <div class="metric-label">Warnings</div>
                            <div class="metric-value" id="metric-warnings">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas fa-bell"></i></div>
                            <div class="metric-label">Critical</div>
                            <div class="metric-value" id="metric-critical">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- Steering Guidance -->
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-compass"></i>
                        Lane Keeping Assistance
                    </div>
                    <div class="lkas-display">
                        <div class="lkas-wheel-container">
                            <img src="{{ url_for('static', filename='assets/steering_wheel.png') }}" alt="Steering" class="lkas-wheel" id="lkas-wheel"
                                 onerror="console.error('Failed to load LKAS steering wheel'); this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22120%22 height=%22120%22%3E%3Ccircle cx=%2260%22 cy=%2260%22 r=%2250%22 fill=%22%23667eea%22/%3E%3C/svg%3E';">
                            <div class="lkas-status" id="lkas-status">INACTIVE</div>
                        </div>
                        <div class="lkas-info">
                            <div class="lkas-info-item">
                                <span class="lkas-label">Steering Angle:</span>
                                <span class="lkas-value" id="lkas-angle-value">0°</span>
                            </div>
                            <div class="lkas-info-item">
                                <span class="lkas-label">Lane Offset:</span>
                                <span class="lkas-value" id="lkas-offset-value">0 px</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Status -->
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-shield-alt"></i>
                        System Status
                    </div>
                    <div class="status-grid">
                        <div class="status-item">
                            <span class="status-label">
                                <i class="fas fa-car-crash"></i> FCWS
                            </span>
                            <span class="status-value status-inactive" id="status-fcws">INACTIVE</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">
                                <i class="fas fa-road"></i> LDWS
                            </span>
                            <span class="status-value status-inactive" id="status-ldws">INACTIVE</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">
                                <i class="fas fa-steering-wheel"></i> LKAS
                            </span>
                            <span class="status-value status-inactive" id="status-lkas">INACTIVE</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>
    
    <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
</body>
</html>
